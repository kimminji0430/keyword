<!DOCTYPE html>
<html>
<head>
    <title>키워드 추천기 (수식 기반)</title>
    <meta charset="UTF-8">
    <style>
        body { font-family: '맑은 고딕', Arial, sans-serif; margin: 30px; }
        textarea { width: 100%; font-size: 16px; }
        button { margin-top: 8px; font-size: 16px; }
        #result { margin-top: 20px; font-size: 18px; font-weight: bold; }
    </style>
</head>
<body>
    <h2>텍스트 입력</h2>
    <textarea id="textInput" rows="7" placeholder="분석하고 싶은 글을 입력하세요!"></textarea><br>
    <button onclick="recommend()">키워드 추천</button>
    <h3>추천 키워드</h3>
    <div id="result"></div>

    <script>
        function recommend() {
            let text = document.getElementById("textInput").value;

            // 특수문자·영어·숫자 모두 제거, 한글 단어만 추출
            // (한글 2글자 이상만 키워드로 인정)
            let words = text
                .replace(/[^가-힣\s]/g, " ")    // 한글/공백만 남김
                .replace(/\s+/g, " ")           // 여러 공백 정리
                .trim()
                .split(" ")
                .filter(w =>
                    w.length > 1 &&             // 두 글자 이상
                    /[가-힣]/.test(w)           // 한글 포함
                );

            let n = Math.max(1, Math.floor(text.length / 100) + 1);

            // 단어 빈도 계산
            let freq = {};
            words.forEach(function(w){
                freq[w] = (freq[w]||0) + 1;
            });

            // 빈도 높은 순, 동일 빈도면 가나다순
            let sorted = Object.entries(freq)
                .sort((a,b)=>b[1]===a[1]? a[0].localeCompare(b[0]): b[1]-a[1]);

            // 상위 n개 단어 + 동일 빈도 모두 표시
            let resultArr = [];
            let cutoff = sorted.length > 0 ? sorted[Math.min(n-1, sorted.length-1)][1] : 0;
            sorted.forEach(([kw, cnt])=>{
                if(cnt >= cutoff) resultArr.push(`${kw}(${cnt})`);
            });

            document.getElementById("result").innerText = resultArr.length ? resultArr.join(', ') : "키워드 없음";
            // 콘솔에 실제 단어 리스트 출력(확인용)
            console.log(words);
        }
    </script>
</body>
</html>
